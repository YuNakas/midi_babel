# はじめに
MIDI BABELは、音源ごとのキーマップを設定し、音源間のキーマップの違いに合わせて相互変換するソフトです。ドラム音源やサンプラーへの利用を想定しています。

また、MIDI BABELは無料のオープンソースソフトウェアです。
作りとしては出来るだけシンプルに、汎用性を高くすることを意識しています。
pythonでコーディングしているため、必要であればユーザ側で改変して利用することも可能です。

# 使い方
## インストール
以下のurlから、最新のリリースファイルをダウンロードしてください。  
`https://github.com/YuNakas/midi_babel/releases`

![image](https://github.com/YuNakas/midi_babel/assets/88542340/c5d61915-c2bc-45b3-bf45-46e829f46fad)

ダウンロードしたzipファイルを解凍し、内包されている`midi_babel.exe`をダブルクリックすることでアプリケーションを起動できます。(※ 初回起動時に警告が表示されることがありますが、許可することで、次回以降は表示されなくなります。)

## トップ画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/a9bfe8a1-413d-4c49-82d6-858190b12d94)

トップ画面からは以下の機能を選択できます。機能の詳細は各画面で改めて説明します。
- MIDI変換
  - 本アプリのメイン機能です。設定したキーマッピングファイルに従って、MIDIノートの音階を書き換えます。
- オマケ機能
  - MIDI変換のうち、個人的に欲しかった機能を 3 つ用意しました。
- ファイルの保存・取込
  - 設定ファイルのインポート・エクスポートや、過去に変換したmidiファイルをもう一度保存することができます。

## MIDI変換機能
### MIDI選択画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/6b6bcebd-dc75-4b21-b28c-c3bb539f6711)

画面左上のボタンから変換したいMIDIファイルを取り込んで、ファイル名を左クリックで選択します。

---
### MIDIトラック選択画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/1d46eed8-04ea-4120-84a3-5030255d14d5)

変換したいトラックを選択します。
- メロディトラックとして選択
  - 音階楽器(ギターやボーカル、ベースなど)を変換する際はこちらをクリックします。
- リズムトラックとして選択
  - 非音階楽器(ドラムやパーカッションなど)を変換する際はこちらをクリックします。

> ※ メロディトラック/リズムトラックの選択について
> 
> 本機能は、楽譜ソフトへの取込時に支障をきたさないように搭載している機能となります。  
> midiデータはチャンネル番号を持っており、リズム楽器は通常 9 と 10 のチャンネルが割り当てられています。  
> メロディトラックを選択した場合はチャンネル番号の変換はなく、  
> リズムトラックを選択した場合はチャンネル番号を 9 に変換する処理をあわせて実施します。

---
### MIDI変換元/変換先 選択画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/81d7add8-bcf0-4ae7-a545-cfb0279bc374)

変換元/変換先のキーマッピングを設定したファイルを選択します。  
すでにキーマッピング設定ファイルが存在する場合、`選択`ボタンをクリックします。  
キーマッピング設定ファイルを編集したい場合、`編集`ボタンをクリックします。  
キーマッピング設定ファイルが存在しない場合、左上の`新規作成`ボタンをクリックします。

---
### キーマッピング設定ファイル名称設定画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/27d99d1f-bd65-4b42-a06e-9c5e484a4c18)

キーマッピング設定ファイルのファイル名を設定します。

---
### キーマッピング設定ファイル編集画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/51ce3109-8955-4bf4-8e4c-3f3ea8d1bfa1)

キーマッピングを編集します。  
`kick_hit`や`hihat_closed`など、キーの名称を左上のテキストボックスに入力して、`追加`ボタンをクリックします。  
音階に対応したノートナンバーを入力します。
> ※ 音階の表示について
> 
> 通常、midiの音階は `アルファベット` + `数字` の形で表す `音名` を用います。  
> しかし、記法によって最低音が `C-1` の場合と `C-2` の場合があるため、  
> より厳格な仕様である**ノートナンバー**を利用しています。  
> 音名とノートナンバーの対応表は本マニュアルの最下部に記載しています。

> 優先ノート と ノート一覧 について
>
> ドラム音源によっては、同じ音に対して複数の音階が割り当てられていることがあります。  
> 例えば、EzDrummer3では、snare の center に対して `D1(38)` と `F#3(66)` が割り当てられています。  
> その場合、`38` と `66` を**ノート一覧**に記述します。  
> また、そのうち、優先して利用したいものを一つだけ選んで、**優先ノート**に記述します。  

入力中は、こまめに右上の`保存`ボタンをクリックすることをおすすめします。  
入力が完了したら、右上の`この内容で決定する`ボタンをクリックします。  

---
### 変換表生成画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/b7953830-fe6a-4594-972b-458b3da2db18)

変換元のキー名を、変換先のどのキーに割り当てるかを設定する画面です。

右側のドロップダウンをクリックして変換先キー名を選択します。キー名は重複しても問題ありません。  
選択が完了したら、左上の`決定`ボタンをクリックします。

---
### 変換完了画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/129ff1c0-e8b9-4abe-ad85-dce3b372d951)

`MIDIエクスポート`ボタンをクリックすると、変換後のMIDIファイルが保存できます。  
`Topへ戻る`ボタンをクリックすると、トップ画面に戻ります。

---
## オマケ機能
### 変換モード選択画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/687927fb-86ae-455f-b2bd-816c029b64d0)

- Tautology
  - 音階を変更せずにmidiファイルを出力します。midiファイルから1トラックだけ抽出したいときなどに使います。
- Octave Up/Down
  - 音階を1オクターブ上げ下げします。

---
## ファイルの保存・取込
### インポート・エクスポート選択画面
![image](https://github.com/YuNakas/midi_babel/assets/88542340/09eaa7c6-6f08-47a3-b334-75291967df6b)

- 設定ファイルをエクスポート
  - 作成したキーマッピング設定ファイルなどをエクスポートします。本ソフトウェアのバージョンを上げる際などに使います。
- 設定ファイルをインポート
  - 前項の`設定ファイルをエクスポート`でエクスポートしたファイルをインポートします。本ソフトウェアのバージョンを上げる際などに使います。
- 変換済みmidiファイルをエクスポート
  - 過去に生成した変換後midiファイルを保存します。

---
# 音名とノートナンバーの対応表
|最低音が C-2 の場合|最低音が C-1 の場合|ノートナンバー|
|:---:|:---:|:---:|
|C-2|C-1|0|
|C#-2|C#-1|1|
|D-2|D-1|2|
|D#-2|D#-1|3|
|E-2|E-1|4|
|F-2|F-1|5|
|F#-2|F#-1|6|
|G-2|G-1|7|
|G#-2|G#-1|8|
|A-2|A-1|9|
|A#-2|A#-1|10|
|B-2|B-1|11|
|C-1|C0|12|
|C#-1|C#0|13|
|D-1|D0|14|
|D#-1|D#0|15|
|E-1|E0|16|
|F-1|F0|17|
|F#-1|F#0|18|
|G-1|G0|19|
|G#-1|G#0|20|
|A-1|A0|21|
|A#-1|A#0|22|
|B-1|B0|23|
|C0|C1|24|
|C#0|C#1|25|
|D0|D1|26|
|D#0|D#1|27|
|E0|E1|28|
|F0|F1|29|
|F#0|F#1|30|
|G0|G1|31|
|G#0|G#1|32|
|A0|A1|33|
|A#0|A#1|34|
|B0|B1|35|
|C1|C2|36|
|C#1|C#2|37|
|D1|D2|38|
|D#1|D#2|39|
|E1|E2|40|
|F1|F2|41|
|F#1|F#2|42|
|G1|G2|43|
|G#1|G#2|44|
|A1|A2|45|
|A#1|A#2|46|
|B1|B2|47|
|C2|C3|48|
|C#2|C#3|49|
|D2|D3|50|
|D#2|D#3|51|
|E2|E3|52|
|F2|F3|53|
|F#2|F#3|54|
|G2|G3|55|
|G#2|G#3|56|
|A2|A3|57|
|A#2|A#3|58|
|B2|B3|59|
|C3|C4|60|
|C#3|C#4|61|
|D3|D4|62|
|D#3|D#4|63|
|E3|E4|64|
|F3|F4|65|
|F#3|F#4|66|
|G3|G4|67|
|G#3|G#4|68|
|A3|A4|69|
|A#3|A#4|70|
|B3|B4|71|
|C4|C5|72|
|C#4|C#5|73|
|D4|D5|74|
|D#4|D#5|75|
|E4|E5|76|
|F4|F5|77|
|F#4|F#5|78|
|G4|G5|79|
|G#4|G#5|80|
|A4|A5|81|
|A#4|A#5|82|
|B4|B5|83|
|C5|C6|84|
|C#5|C#6|85|
|D5|D6|86|
|D#5|D#6|87|
|E5|E6|88|
|F5|F6|89|
|F#5|F#6|90|
|G5|G6|91|
|G#5|G#6|92|
|A5|A6|93|
|A#5|A#6|94|
|B5|B6|95|
|C6|C7|96|
|C#6|C#7|97|
|D6|D7|98|
|D#6|D#7|99|
|E6|E7|100|
|F6|F7|101|
|F#6|F#7|102|
|G6|G7|103|
|G#6|G#7|104|
|A6|A7|105|
|A#6|A#7|106|
|B6|B7|107|
|C7|C8|108|
|C#7|C#8|109|
|D7|D8|110|
|D#7|D#8|111|
|E7|E8|112|
|F7|F8|113|
|F#7|F#8|114|
|G7|G8|115|
|G#7|G#8|116|
|A7|A8|117|
|A#7|A#8|118|
|B7|B8|119|
|C8|C9|120|
|C#8|C#9|121|
|D8|D9|122|
|D#8|D#9|123|
|E8|E9|124|
|F8|F9|125|
|F#8|F#9|126|
|G8|G9|127|
